%% DDALAB System Architecture - Mermaid Diagram
%% View at: https://mermaid.live/
%% Or render with: npx -p @mermaid-js/mermaid-cli mmdc -i architecture_diagram.mmd -o architecture_diagram.png

graph TB
    subgraph standalone["üñ•Ô∏è STANDALONE DESKTOP DEPLOYMENT"]
        direction TB
        UI1["Tauri Desktop Application<br/>(React + TypeScript)"]
        API1["Embedded Rust API<br/>(Axum Web Server)"]
        EDF1["Custom EDF Reader"]
        DDA1["DDA Binary Executor"]
        FILES1["Local Filesystem<br/>(EDF Files & Results)"]

        UI1 <-->|"localhost:8765"| API1
        API1 --> EDF1
        API1 --> DDA1
        EDF1 <--> FILES1
        DDA1 <--> FILES1
    end

    subgraph institutional["üè¢ INSTITUTIONAL DEPLOYMENT"]
        direction TB
        UI2["Tauri Desktop Application<br/>(React + TypeScript)"]

        subgraph docker["Docker Services"]
            direction TB
            TRAEFIK["Traefik<br/>(SSL/TLS Proxy)"]
            FASTAPI["FastAPI Server<br/>(GraphQL + REST)"]

            subgraph backend["Backend Services"]
                direction LR
                POSTGRES["PostgreSQL<br/>(Database)"]
                REDIS["Redis<br/>(Cache)"]
                MINIO["MinIO<br/>(Object Storage)"]
            end

            DDA2["dda_py<br/>(Python Package)"]

            TRAEFIK <--> FASTAPI
            FASTAPI <--> POSTGRES
            FASTAPI <--> REDIS
            FASTAPI <--> MINIO
            FASTAPI --> DDA2
        end

        UI2 <-->|"HTTPS"| TRAEFIK
    end

    subgraph features["Common Capabilities"]
        direction LR
        F1["Custom EDF Reader"]
        F2["DDA Analysis"]
        F3["Real-time Visualization"]
        F4["State Persistence"]
        F5["Cross-platform Support"]
    end

    classDef tauri fill:#ffc706,stroke:#333,stroke-width:2px,color:#000
    classDef rust fill:#ce5c00,stroke:#333,stroke-width:2px,color:#fff
    classDef docker fill:#00b6ff,stroke:#333,stroke-width:2px,color:#000
    classDef fastapi fill:#009688,stroke:#333,stroke-width:2px,color:#fff
    classDef service fill:#e8e8e8,stroke:#333,stroke-width:2px,color:#000

    class UI1,UI2 tauri
    class API1,EDF1,DDA1,DDA2 rust
    class TRAEFIK docker
    class FASTAPI fastapi
    class POSTGRES,REDIS,MINIO,FILES1 service
